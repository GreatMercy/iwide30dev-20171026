<template>
<div class="gradient_bg">
  <section class="padding_0_15 padding_top_18">
    <div class="padding_0_16 padding_bottom_40">
      <div class="padding_0_9 margin_top_15">
        <div class="radius_10 overflow ka relative">
          <!-- <img src="../../assets/image/platinum.jpg" alt=""> -->
          <img :src="dataList.card.logo_url"  alt="">
          <!-- <div class="hotel_logo absolute"><img class="block" :src="dataList.card.logo_url" alt=""/></div> -->
        </div>
      </div>
    </div>
    <div class="bd_top"></div>
    <section class="font_16 mar_t40">
      <div class="overflow">
        <p class="float font_16">{{dataList.card.title}}</p>
        <p class="floatr main_color1">
          <em class="iconfont font_19">&#xe643;</em>
          <span class="iconfonts font_25">{{dataList.card.money}}</span>
        </p>
      </div>
      <p class="font_15 mar_tb20">{{dataList.card.notice}}</p>
      <div class="pad_t60">
        <div class="width_109 center relative auto color_fff">
          支付方式
          <span class="shadow_b" style="display:block"></span>
        </div>
      </div>
      <div class="flex margin_top_35 pay_mode">
        <div v-for="(value,key) in dataList.pay_type" @click="paytype=key" class="layer_bg flex_1 center radius_3 pay_mode_item relative mar_lr10" :class="{check_item: paytype === key }">
          <div class="check"><em></em></div>
          <div><em class="iconfont font_22">&#xe64e;</em></div>
          <div class="margin_top_15"><font>{{value}}</font></div>
        </div>
      </div>
    </section>
    <section class="padding_bottom_77 margin_top_50">
      <div class="font_12 padding_left_20">
        <p class="color2 relative"><em class="iconfont absolute prompt">&#xe642;</em>使用说明</p>
        <p class="color3 margin_top_15">{{dataList.card.description}}</p>
      </div>
    </section>
  </section>
  <section class="flex layer_bg fixed_btn font_17 color_fff">
    <div class="flex_1 padding_left_30 padding_17"><font class="font_12">¥</font><em>{{dataList.card.money}}</em></div>
    <div class="iconfont width_150 center main_bg1 padding_17" @click="submit()">&#xe63b;&#xe63a;&#xe639;&#xe638;</div>
  </section>
</div>
</template>
<script>
import { getDepositcardDetail, getBuyCard } from '@/service/http'
import { formatUrlParams } from '@/utils/utils'
export default {
  data () {
    return {
      dataList: [],
      paytype: 'wechat'
    }
  },
  created () {
    let params = formatUrlParams(location.search)
    let setdata = {'cardId': params.id}
    console.log(setdata)
    getDepositcardDetail(setdata).then((res) => {
      this.dataList = res.web_data
    })
  },
  methods: {
    submit () {
      let data = {
        cardId: this.dataList.card.deposit_card_id,
        pay_type: this.paytype
      }
      getBuyCard(data).then((res) => {
        window.location.href = res.web_data.page_resource.links.redirect
      })
    }
  }
}
</script>
