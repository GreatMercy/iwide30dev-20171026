<template>
  <div class="jfk-pages jfk-pages__order-center">
    <div class="jfk-pages__theme"></div>
    <ul class="order-center-tab jfk-flex is-align-middle">
      <li class="order-center-tab__item font-size--32 jfk-ta-c" v-for="(item, index) in tabsItems"
          :class="{'order-center-tab__active': selected === index}" @click="changeTab(index)">
        <i class="jfk-d-ib jfk-font icon-user_icon_Polite_nor" v-if="item.icon"></i>{{item.text}}
      </li>
    </ul>
    <ul class="order-list jfk-pr-30 jfk-pl-30" v-infinite-scroll="loadMore"
        infinite-scroll-disabled="disableLoadProduct" :infinite-scroll-distance="0">
      <li v-for="(item,index) in orderList" :key="item.order_id">
        <a href="">
          <div class="jfk-flex is-align-middle order-list__order-info">
            <!--<div  class="font-size&#45;&#45;28 order-list__order-id">赠送编号：{{item.order_id}}</div>-->
            <div class="font-size--28 order-list__order-id">订单号：{{item.order_id}}</div>
            <div class="font-size--30 jfk-ta-r order-list__status"
                 v-if="item.consume_status == 21 || item.consume_status == 22">
              购买成功
            </div>
            <div class="font-size--30 jfk-ta-r order-list__status"
                 v-else-if="item.consume_status == 23">已完成
            </div>
            <div class="font-size--30 jfk-ta-r order-list__status"
                 v-else-if="item.refund_status == 33">已退款
            </div>
            <!--<div v-else-if="order_type == 3" class="font-size&#45;&#45;30 jfk-ta-r order-list__status"-->
            <!--&gt;<i-->
            <!--class="jfk-font icon-user_icon_Polite_nor"></i>收礼成功-->
            <!--</div>-->
          </div>
          <div class="order-list__info jfk-flex">
            <div v-if="item.package[0].face_img" v-lazy:background-image="item.package[0].face_img"
                 class="order-list__goods-img  jfk-image__lazy--3-3 jfk-image__lazy--background-image"
                 :key="item.package[0].item_id">
            </div>
            <div v-else
                 class="order-list__goods-img jfk-image__lazy--preload  jfk-image__lazy--3-3 jfk-image__lazy--background-image"
                 :key="item.package[0].item_id">
            </div>
            <div class="order-list__base-info">
              <p class="order-list__name font-size--38">{{item.item_name}}</p>
              <p class="order-list__number font-size--24"><span>数量&nbsp&nbsp</span>{{item.row_qty}}</p>
            </div>
          </div>

        </a>

        <div v-if="item.consume_status == 21 || item.consume_status == 22" class="order-list__button jfk-ta-r">
          <button class="jfk-button jfk-button--primary  font-size--30">
            <span class="jfk-button__text">
            <i class="jfk-font jfk-button__text-item icon-font_zh_li_qkbys"></i>
            <i class="jfk-font jfk-button__text-item icon-font_zh_ji_qkbys"></i>
            <i class="jfk-font jfk-button__text-item icon-font_zh_cha_qkbys"></i>
            <i class="jfk-font jfk-button__text-item icon-font_zh_kan_qkbys"></i>
            </span>
          </button>
        </div>
        <div v-else class="order-list__button jfk-ta-r">
          <button class="jfk-button font-size--24 jfk-button--primary order-list__delete">
              <span class="jfk-button__text">
              <i class="jfk-font jfk-button__text-item icon-font_zh_shan_qkbys"></i>
              <i class="jfk-font jfk-button__text-item icon-font_zh_chu_qkbys"></i>
              </span>
          </button>

          <button class="jfk-button jfk-button--primary  font-size--30 is-plain">
              <span class="jfk-button__text">
              <i class="jfk-font jfk-button__text-item icon-font_zh_zai__qkbys"></i>
              <i class="jfk-font jfk-button__text-item icon-font_zh_ci_qkbys"></i>
              <i class="jfk-font jfk-button__text-item icon-font_zh_gou_qkbys"></i>
              <i class="jfk-font jfk-button__text-item icon-font_zh_mai_qkbys"></i>
              </span>
          </button>
        </div>
      </li>


    </ul>
  </div>
</template>

<script>
  import {getOrderList} from '@/service/http'

  export default {
    components: {},
    created () {
    },
    methods: {
      changeTab (item) {
        this.selected = item
        this.order_type = item + 1
        this.orderList = []
        this.page = 1
        this.loadOrderList()
      },
      loadOrderList () {
        getOrderList({page: this.page, page_size: this.page_size, type: this.order_type}).then((res) => {
          this.orderList = this.orderList.concat(res.web_data.products)
          this.disableLoadProduct = false
          this.page += 1
        }).catch(() => {
          this.disableLoadProduct = false
        })
      },
      loadMore () {
        this.loadOrderList()
      }
    },
    data () {
      return {
        selected: 0,
        tabsItems: [{
          'id': 0,
          'text': '全部'
        }, {
          'id': 1,
          'text': '待使用'
        }, {
          'id': 2,
          'text': '已完成'
        }, {
          'id': 3,
          'text': '我的礼物',
          'icon': true
        }],
        disableLoadProduct: false,
        orderList: [],
        page: 1,
        page_size: 5,
        order_type: 1
      }
    }
  }
</script>
