<template>
  <swiper :options="recommendationSwiperOptions"  class="jfk-swiper jfk-swiper__recommendation">
    <swiper-slide v-for="(item, index) in lists" :key="index" :class="{'jfk-swiper__item': true, 'jfk-swiper__item--empty': item._isEmpty}">
        <img src="http://30.iwide.cn:821/public/media/a450089706/adv/logo/20160613171158.jpg" alt="" class="city_swiper_img">
        <div class="swiper_mask font-size--30">
          法国
        </div>
    </swiper-slide>
  </swiper>
</template>
<script>
  export default {
    name: 'jfk-cityswiper',
    data () {
      return {
        defaultEmptyHtml: '<div class="jfk-flex is-justify-center is-align-middle"><div class="box"><p class="font-size--28 font-color-extra-light-gray zh">查看更多</p><p class="en font-size--24 font-color-light-gray">VIEW&nbsp;&nbsp;&nbsp;MORE</p></div></div>',
        lists: [],
        recommendationSwiperOptions: {
          autoplay: 0,
          lazyLoading: true,
          lazyLoadingInPrevNext: true,
          lazyPreloaderClass: 'jfk-image__lazy--preload',
          spaceBetween: 15,
          slidesPerView: 2.3571
        }
      }
    },
    created () {
      let _lists = []
      let that = this
      let num = 3 - that.items.length
      if (num > 0) {
        let i = 0
        while (i < num) {
          that.items.push({
            _isEmpty: true
          })
          i++
        }
      }
      _lists = that.items.map(function (item, index) {
        if (that.formatProductInfo) {
          return that.formatProductInfo(item, index)
        }
        return that.formatProductInfoInner(item, index)
      })
      that.lists = _lists
    },
    methods: {
      formatProductInfoInner (item) {
        if (item._isEmpty) {
          return {
            _link: item._link || this.emptyLink,
            _html: this.defaultEmptyHtml,
            _isEmpty: true
          }
        }
        return {
          _link: this.linkPrefix + item.product_id,
          _img: item.face_img,
          _name: item.name,
          _pricePackage: item.killsec ? item.killsec.killsec_price : item.price_package,
          _priceMarket: item.price_market,
          _integral: item.type === '5'
        }
      }
    },
    props: {
      formatProductInfo: {
        type: Function
      },
      items: {
        type: Array,
        required: true
      },
      linkPrefix: {
        type: String
      },
      emptyLink: {
        type: String
      }
    }
  }
</script>
